release:
  stage: release
  image: curlimages/curl:latest
  script:
    - |
      curl --header "PRIVATE-TOKEN: $GITLAB_API_TOKEN" --data "name=Release v${VERSION}&tag_name=${RELEASE_TAG}&description=System Monitor service v${VERSION}&assets[links][0][name]=${PACKAGE_NAME}_${VERSION}.deb&assets[links][0][url]=${CI_PROJECT_URL}/-/jobs/${CI_JOB_ID}/artifacts/file/${DEB_FILE}" "https://gitlab.com/api/v4/projects/${CI_PROJECT_ID}/releases"
  needs: [build_deb]
  rules:
    - if: '$CI_COMMIT_BRANCH == "main"'